使用lua在openresty中实现的waf功能
---

## **介绍**
1. 使用`openresty`中封装的`luajit`，配合`lua`共享内存、`redis`实现的一种基础的、可私有化部署的waf功能，提供使用`auth_basic`认证登录的控制页面。

2. 主要功能
2.1 **`ip黑白名单`** **`限流策略`** **`区域封禁`** **`请求方法限制`** **`规则库/字段匹配`**
---

## **功能**
### **ip黑白名单**
使用本地文件保存ip信息，openresty每次启动时用`init_by_lua_file`加载ip文件列表的内容到预定义的共享缓存块中.

### **限流策略**
针对每一个独立的请求ip配置指定时间指定次数的访问限制，效果：
- 永久限制
- 限制指定时间
- 限制该ip新建连接

### **区域封禁**
请求进入后
- ip信息在redis中
查询属地信息保存到redis中，同时执行封禁策略

- ip信息不在redis中
从远程服务器获取属地信息

### **请求方法限制**
限制不被允许的请求方法

### **规则库/字段匹配**
在整个请求信息中匹配指定敏感字符串，如sql关键字、xss关键字
